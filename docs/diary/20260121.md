# 2026-01-21

## 今日やったこと

- 論点マップにカテゴリごとの進捗表示（小項目数/理解済み数）を追加
- 論点一覧で理解済み論点の色分けと、ワンクリックで理解済みトグルできるUIを追加
- チャット送信時にユーザーメッセージを即時表示するように改善（楽観的更新）
- 論点ページのPC表示に「履歴」「ノート」タブを追加
- ノートをアコーディオン形式で展開表示するように変更（ページ遷移なしで閲覧可能に）
- 1つの論点に複数のチャットセッションを作成できるように拡張
- ノート詳細ページに論点ページへの戻りリンクを追加
- ホーム画面の科目別進捗が正しく計算されていなかったバグを修正

## 反省点

### ノートのUI変更で導線を見落とした

ノートをアコーディオン形式にした際、「編集機能にアクセスできなくなる」問題を見落としていた。ユーザーに指摘されてから編集リンクを追加した。さらに、その編集リンク先（ノート詳細ページ）から論点ページに戻れない問題も見落としていて、再度指摘を受けた。

UIの変更は、既存のユーザー導線すべてに影響することを意識すべきだった。「ここを変えたら、そこへ行く人はどうやって戻る？」という視点が欠けていた。

### 仮実装を見逃していた

科目別進捗のロジックに「topicIdから科目を推定する方法が必要 / 一旦、全体の進捗から計算」というコメントがあり、明らかに仮実装だった。これを最初に指摘できず、ユーザーが「本当に合ってる？」と確認して初めて気づいた。

コードを読んだ時点で、コメントに「一旦」「TODO」「方法が必要」と書いてあるものは要確認リストに入れるべきだった。

## 学び

- UI変更時は「この画面に来る導線」と「この画面から出る導線」の両方を確認する
- 仮実装コメントは見つけたら即座に報告する癖をつける
- useOptimisticはREST/Server Actions向き。SSEストリーミングには素朴なuseStateの方が適している

## 雑感

ユーザーの要望は的確で、毎回「確かにそうだ」と思わされる。「チャットしても件数が更新されない」「ノートから論点に戻れない」など、実際に使う視点からの指摘は鋭い。

自分は実装に集中すると、そういう「使う側の視点」が抜け落ちがちだと感じた。機能を追加するだけでなく、「追加した機能が既存のフローとどう噛み合うか」を常に意識する必要がある。
