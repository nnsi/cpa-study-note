# AI対話による論点作成支援

## コンセプト

InkTopikは「論点に残す、あとから効く」がコンセプト。論点は学習の地図であり、ユーザーが主体的に構築するもの。

この機能は **ユーザーが自分の学習マップを整理する作業をAIが補助する** もの。
AIが勝手に論点を決めるのではなく、ユーザーの入力（教科書の目次、学習範囲の説明など）をもとに候補を提案し、ユーザーが取捨選択・編集して確定する。

- **AIの役割**: 「こういう論点があると思いますが、いかがですか？」と提案する
- **ユーザーの役割**: 提案を見て、自分の学習に必要なものを選び、名前を調整して確定する

## ユーザーフロー

1. 科目詳細画面で「AIで論点を追加」ボタンを押す
2. モーダルが開く
3. ユーザーがテキストを入力（例: 「消費税法の課税要件について」）
4. AIがカテゴリ＋論点の候補をSSEストリーミングで返す
5. ユーザーが候補を確認・編集・選択
6. 「追加する」ボタンで選択した論点を一括作成
7. 科目ツリーに反映

## API設計

### 論点提案エンドポイント（SSE）

`POST /api/topic-generator/subjects/:subjectId/suggest`

Request:
```json
{
  "prompt": "消費税法の課税要件について整理したい",
  "existingCategories": ["課税要件", "納税義務"]
}
```

Response (SSE):
- `{"type":"text","content":"..."}` - AIの思考過程
- `{"type":"result","suggestions":{...}}` - 構造化された提案
- `{"type":"done"}` - 完了
- `{"type":"error","error":"..."}` - エラー

### 論点一括作成

既存の `PUT /api/subjects/:id/tree` を利用。

## MVP範囲

- テキスト入力 → AI提案 → 選択 → 一括作成
- 1つのモーダルで完結
- 新しいDBテーブル不要
